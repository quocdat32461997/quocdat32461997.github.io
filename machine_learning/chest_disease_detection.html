---
layout: default
---
<h1> Transfer Learning for Chest Disease Detection </h1>

<p>
	September 2019 - I and 3 other students joined an AI Medical Hackathon
	held by Mr. Tarry Singh and Cuare AI. This is to show steps we made
	during the competition.
</p>


<p>
	<h4>Problem: </h4>
	X-ray scans of chest areas have been used to detect cancer and
	other kinds of diseases within Chest area. However, the diagnosis based
	on the X-ray scans by humans is time-consuming. Hence, the question is
	to develop Machine Learning algorithm to quickly identify diseases on
	X-Ray scans.

	<br>
	<img src = "images/x-ray-scan.png"/>
</p>

<section class = "eda">

	<section id = "inspect_features">
		<h4> Perform Data Explanatory Data Analysis </h4>
		<p>
			Obviously, the given dataset contains: <br>
				* Finding labels - Disease name: these labels would be encoded to classes for multi-binary classification <br>
				* Other features: not considered as out of scope of this blog
		</p>
		<img src = "images/data_inspect.png"
	</section>
	<section id = "data_stats">
		<p> <br> One conclusion here is the meadian age of all patients is 48.47. Obviously, if look at max row, we observed the odd age of 414 which would be changed to 100</p>
		<img src = "images/data_stats.png"
	</section>

	<section id = "encode classes of diseases">
		<br>
		<h4>Feature Engineering</h4>
		<p> Encode classes of 14 types of diseases as following: </p>
		<ul>
			<li> Cardiomegaly - 0 </li>
			<li> Emphysema - 1 </li>
			<li> Effusion - 2 </li>
			<li> Hernia - 3 </li>
			<li> Infiltration - 4 </li>
			<li> Mass - 5 </li>
			<li> Nodule - 6 </li>
			<li> Atelectasis - 7 </li>
			<li> Pneumothorax - 8 </li>
			<li> Pleural_Thickening - 9 </li>
			<li> Pneumonia - 10 </li>
			<li> Fibrosis - 11 </li>
			<li> Edema - 12 </li>
			<li> Consolidation - 13 </li>
		</ul>
	</section>

	<section id = "image_processing">
		<h4>Build data loader</h4>
		<p>
			In Image Processing, standardizing images is a necessary technique to prevent
			over-explosion of features. When taking standardization, we look for the standard normal distribution within images.
			Standardizing is implemented within the customized dataloader by using <u>Sequence</u> class from Keras and <u>process_input</u> function desgined by mobilenet_v2. <br><br>
			The dataloder return 2 objects: batches of images and batches of labels (disease classes).
		</p>
		<img src = "images/data_loader_w_standardizing.png"/>
	</section>

	<section id = "transfer_learning">
		<h4> Leverage Transfer Learning: VGG-16 pre-trained model by Google </h4>
		<img src = "images/vgg_16.png"/>

		<br>
		<h4> Training </h4>
		<ul>
			<li> Learning rate: 0.0001 </li>
			<li> Epochs: 10 (due to limited time but 10 supposed to yeilf high accuracy)</li>
			<li> Loss function: Binary Corres-entropy</li>
			<li> Optimizer: Adam (Adam is a general and best-performing optimizer in usual cases)</li>
		</ul>
		<img src = "images/training_result.png"/>
	</section>

	<br>
	<h4> Conclusion </h4>
	<p>
		Obviously, just afer few epochs, the accuracy achieves 88% due to the Transfer
		Learning advantages. VGG-16 and other Transfer Learning models were trained
		with a huge dataset of images; hence, they could capture features of images easily.
		<br><br>
		However, there are concerns that Transfer Learning use in Autoencoder for Image Prediction because
		Transfer Learning was trained specifically for classification. But still, if freezing last few layers of the model,
		features captured by other layers could represent images well.
	</p>
</section>

<p> All codes are available <a href = "https://github.com/quocdat32461997/HealthCareAI_2019/blob/master/code-lab-3-chestxray8-vgg16.ipynb"> here </a> </p>
